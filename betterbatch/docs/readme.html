<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>BetterBatch Readme &mdash; BetterBatch v0.9.3 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.9.3',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="BetterBatch v0.9.3 documentation" href="index.html" />
    <link rel="next" title="Comparing BetterBatch to ..." href="comparison.html" />
    <link rel="prev" title="Contents" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="comparison.html" title="Comparing BetterBatch to ..."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Contents"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">BetterBatch v0.9.3 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="betterbatch-readme">
<h1>BetterBatch Readme<a class="headerlink" href="#betterbatch-readme" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-betterbatch">
<h2>What is BetterBatch<a class="headerlink" href="#what-is-betterbatch" title="Permalink to this headline">¶</a></h2>
<p>BetterBatch is meant as a replacement for batch files. It has the following
advantages over batch files:</p>
<ul class="simple">
<li>easily include commands/variables from other files</li>
<li>set variables from the output of system commands</li>
<li>automatically checks the return value of executed commands</li>
<li>built-in commands to allow easy checking of conditions (e.g. that a file exists)</li>
<li>easier to read variable format</li>
<li>strongly encourages separation of code and configuration</li>
<li>allow easily and safely using external scripts/executables</li>
</ul>
<p>BetterBatch&#8217;s sweet spot is for things that can be done by a batch command and
need to be maintained over time by different people who may not have the same
knowledge of scripts nor want the extra complexity of scripts (which are harder
to maintain).</p>
<p>The following example shows how to check if a file exists and copy from a
location specified on the command line.</p>
<p>First of all enter the following text into a new text file named &#8220;copyfile.bb&#8221;</p>
<div class="highlight-python"><pre>- set file_to_check=&lt;shell.temp&gt;\testing_betterbatch.txt

- if notexists &lt;file_to_check&gt;:
    - copy &lt;file_to_copy&gt; &lt;file_to_check&gt;</pre>
</div>
<p>Now run it by running the following at the DOS prompt</p>
<div class="highlight-python"><pre>bbrun.py copyfile.bb file_to_copy=autoexec.bat</pre>
</div>
</div>
<div class="section" id="instalation">
<h2>Instalation<a class="headerlink" href="#instalation" title="Permalink to this headline">¶</a></h2>
<p>BetterBatch does not have to be installed as a Python Package, just download,
unzip and run bbrun.py.</p>
<p>Note - it does have a requirement on PyYAML (<a class="reference external" href="http://pyyaml.org/">http://pyyaml.org/</a>)
If you have Setuptools you can use the followin command:</p>
<div class="highlight-python"><pre>easy_install -U pyyaml</pre>
</div>
<p>BetterBatch can also be installed as a Python module (if you want to import
and use BetterBatch functionality in python scripts). Use easy_install.py or your
favourite python package installation method.</p>
<p>If you want to associate the BetterBatch extension &#8220;.bb&#8221; with bbrun.py then you
can run:</p>
<div class="highlight-python"><pre>bbrun associate_filetype.bb</pre>
</div>
<p>This expects that python is on the path - but you can update it to your
python installation if python is not on the path.</p>
</div>
<div class="section" id="script-file-syntax">
<h2>Script File Syntax<a class="headerlink" href="#script-file-syntax" title="Permalink to this headline">¶</a></h2>
<div class="section" id="yaml">
<h3>YAML<a class="headerlink" href="#yaml" title="Permalink to this headline">¶</a></h3>
<p>Script files need to be valid YAML, but don&#8217;t worry too much about that!
The major ways that this will affect you are the following:</p>
<blockquote>
<ul class="simple">
<li>Tab characters should be avoided (BetterBatch actually will replace them
and print a warning when it loads a file with tab characters)</li>
<li>avoid colon (:) followed by whitespace other than where dictated by the
BetterBatch syntax. The Yaml parser will treat it as the &#8216;key&#8217; in a &#8216;mapping&#8217;
and it will cause the script not to run.</li>
</ul>
</blockquote>
<p>Note - while a YAML parser is being used to parse the file, some things which
would fail if parsing as YAML directly will pass with betterbatch. This is
because pre-processing is done on the contents of the file before it is passed
to the YAML parser.</p>
</div>
<div class="section" id="statements">
<h3>Statements<a class="headerlink" href="#statements" title="Permalink to this headline">¶</a></h3>
<p>A simple statement starts with a dash (-), whitespace and then the statement.</p>
<p>For example the typical Hello World! BetterBatch script is:</p>
<div class="highlight-python"><pre>- echo Hello World!</pre>
</div>
</div>
<div class="section" id="executable-statements">
<h3>Executable Statements<a class="headerlink" href="#executable-statements" title="Permalink to this headline">¶</a></h3>
<p>Unless a statement is one of the other types it is an Executable Statement</p>
<p>If the executable statement is not a built-in command then it will be
executed in the shell, just as if you typed it at the command line.</p>
<p>Note - by default BetterBatch captures the output of the command
(output and error output) and adds it to the logfile (if set). It will
also by default stop execution of the script if the command returns an
error value (return code other than zero(0)). This behaviour can be modified
by qualifiers.</p>
<dl class="docutils">
<dt>The following qualifiers are available:</dt>
<dd><dl class="first last docutils">
<dt><strong>echo</strong></dt>
<dd>output will still be captured - but it will be echoed to the terminal
after the command has finished running</dd>
<dt><strong>nocheck</strong></dt>
<dd>an error return value from the command will not cause the script to
terminate. A warning will be output in this case - but the script will
continue.</dd>
<dt><strong>ui</strong></dt>
<dd>command output will not be captured by BetterBatch. The output will
go directly to the terminal. This is useful if the command requires
some interaction. For example dir /p requires the user to press a key
after each screen of output.</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="variable-definitions">
<h3>Variable Definitions<a class="headerlink" href="#variable-definitions" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-python"><pre>- set variable_name = variable value</pre>
</div>
</div>
<div class="section" id="variable-references">
<h3>Variable References<a class="headerlink" href="#variable-references" title="Permalink to this headline">¶</a></h3>
<p>You can reference any defined variable by using &lt;variable_reference&gt;.</p>
<p>The value of the variable will replace the variable reference.</p>
<p>If you need to have &lt; or &gt; in your script - then you double them. e.g.</p>
</div>
<div class="section" id="include-statements">
<h3>Include statements<a class="headerlink" href="#include-statements" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-python"><pre>- include path\to\includefile.bb</pre>
</div>
</div>
<div class="section" id="logfile-specification">
<h3>Logfile specification<a class="headerlink" href="#logfile-specification" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-python"><pre>- logfile path\to\logfile.bb</pre>
</div>
</div>
<div class="section" id="if-statements">
<h3>IF statements<a class="headerlink" href="#if-statements" title="Permalink to this headline">¶</a></h3>
<p>These statements allow you to</p>
<p>Example:</p>
<div class="highlight-python"><pre>- if exists this_file:
  and exists that_file:
     - echo Great - both files exist
  else:
     - echo OH! - one of the files does not exist</pre>
</div>
<p>&#8220;and&#8221; or &#8220;or&#8221; can be used with the &#8220;if&#8221; part of the statement. You cannot
mix &#8220;and&#8221; and &#8220;or&#8221; in the same if statement (it should be consistently &#8220;or&#8221;
or &#8220;and&#8221; in a single statement).</p>
<p>CAREFUL - the if/and/or/else all have to line up vertically - or the
statement will not be parsed correctly.</p>
<p>A special case of the condition is the &#8220;defined variable_name&#8221; e.g.</p>
<div class="highlight-python"><pre>- if defined build:
    - echo Value for build is &lt;build&gt;
  else:
    - end 1, The BUILD variable is not set - please specify a value</pre>
</div>
<p>This can be used to require the user to set pass a value at the command
line - and if they do not, to print an informative error message.</p>
</div>
<div class="section" id="executable-sections">
<h3>Executable Sections<a class="headerlink" href="#executable-sections" title="Permalink to this headline">¶</a></h3>
<p>Executable sections can be used in variable definition or executable
statements. The section will be replaced from the output from the section
after executing it.</p>
<p>Examples:</p>
<div class="highlight-python"><pre>- set file_contents = {{{type c:\autoexec.bat }}}
- echo {{{ replace &lt;file_contents&gt; {*a*} {*b*} }}}
- file_list {{{ dir c:\ /b }}}</pre>
</div>
<p>Executable sections can call any built-in command or external command.
Executable sections can reference variables</p>
</div>
<div class="section" id="special-variables">
<h3>Special Variables<a class="headerlink" href="#special-variables" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>__script_dir__</strong></dt>
<dd>The directory where the script file is stored. Note - these values are
not changed for included scripts, included scripts use the same values
as the including scripts</dd>
<dt><strong>__script_filename__</strong></dt>
<dd>The filename of the script.</dd>
<dt><strong>__working_dir__</strong></dt>
<dd>The current directory when the script was executed.</dd>
</dl>
<p>For example if you runn the following command:</p>
<div class="highlight-python"><pre>c:\Program Files\betterbatch&gt; bbrun.py c:\MyProject\MakeBuild.bb</pre>
</div>
<p>then the values of the special variables will be:</p>
<div class="highlight-python"><pre>__script_dir__        c:\MyProject
__script_filename__   MakeBuild.bb
__working_dir__       c:\Program Files\betterbatch</pre>
</div>
<dl class="docutils">
<dt><strong>shell.*</strong></dt>
<dd><p class="first">Shell environment variables are pre-fixed with &#8216;shell.&#8217; to avoid conflicts
with any internal variables.</p>
<p class="last">For example if your script expects the user to pass a &#8216;buildnumber&#8217; value
to the script, but the environment has a &#8216;buildnumber&#8217; variable defined.
Without the pre-fix the environment variable would have been used silently
if no value was passed to the script. The shell prefix makes it clearer
that the BetterBatch script is going to use the environment value.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting:<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">BetterBatch Readme</a><ul>
<li><a class="reference external" href="#what-is-betterbatch">What is BetterBatch</a></li>
<li><a class="reference external" href="#instalation">Instalation</a></li>
<li><a class="reference external" href="#script-file-syntax">Script File Syntax</a><ul>
<li><a class="reference external" href="#yaml">YAML</a></li>
<li><a class="reference external" href="#statements">Statements</a></li>
<li><a class="reference external" href="#executable-statements">Executable Statements</a></li>
<li><a class="reference external" href="#variable-definitions">Variable Definitions</a></li>
<li><a class="reference external" href="#variable-references">Variable References</a></li>
<li><a class="reference external" href="#include-statements">Include statements</a></li>
<li><a class="reference external" href="#logfile-specification">Logfile specification</a></li>
<li><a class="reference external" href="#if-statements">IF statements</a></li>
<li><a class="reference external" href="#executable-sections">Executable Sections</a></li>
<li><a class="reference external" href="#special-variables">Special Variables</a></li>
</ul>
</li>
<li><a class="reference external" href="#troubleshooting">Troubleshooting:</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Contents</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="comparison.html"
                                  title="next chapter">Comparing BetterBatch to ...</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/readme.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="comparison.html" title="Comparing BetterBatch to ..."
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Contents"
             >previous</a> |</li>
        <li><a href="index.html">BetterBatch v0.9.3 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Mark Mc Mahon.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>